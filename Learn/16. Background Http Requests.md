# Http Requests - Transfer Data Between Client & Server (Network Requests)

In this course, you will learn about:

- `XMLHttpRequest` & `fetch()` API
- JSON Data & FormData
- GETing Data & POSTing Data

## Behind the Scenes Requests

Let's describe it with an image (from academind):

![Http-Request](https://i.ibb.co/VVBG5nN/Screenshot-20201008-052719.png)

## How Websites Work

Let's start with the most obvious way of using the internet: You visit a website like **persiansight.com**.

The moment you enter this address in your browser and you hit **enter**, a lot of different things happen (from academind):

1. The URL gets resolved
2. A Request is sent to the server of the website
3. A response of the server is parsed
4. The page is rendered and displayed

|`<script>` (Client-side)|Server-side|
|:-:|:-:|
|Frontend, detached from backend|May run on different server (i.e. different domain)
|Responsible for fetching & sending data|Responsible for storing & retrieving data (with database)|

The communication between the client-side and the server happens with the help of **HTTP Request / Response**. These **HTTP Request / Response** have to be configured and set up in a certain way.

When we're sending a request to the server, it needs to know the address (i.e. it needs to know the URL) made up of the domain and the path. The **path** is the part after the domain, for example:

- `URL`: persiansight.com/posts
- `Domain`: persiansight.com
- `Path`: /posts

Each Http Request has a Http method that is assigned to it. These are:

- `GET` => To get data: The `GET` method requests a representation of the specified resource. Requests using `GET` should only retrieve data.

- `POST` => To create data: The `POST` method is used to submit an entity to the specified resource, often causing a change in state or side effects on the server.

- `PATCH` => To update data: The `PATCH` method is used to apply partial modifications to a resource.

- `PUT` => To update data: The `PUT` method replaces all current representations of the target resource with the request payload.

- `DELETE` => To delete data: The `DELETE` method deletes the specified resource.

Learn more in MDN: <https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods>

> HTTP body: <https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages>

> Status code: <https://developer.mozilla.org/en-US/docs/Web/HTTP/Status>

> HTTP header: <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers>

If we use a combination that is not supported by the server-side, we'll get a Http error as a response.

## Sending a GET Request

How can we send HTTP request? We can use `XMLHttpRequest` object, for example:

```js
const xhr = new XMLHttpRequest();
```

We use `XMLHttpRequest` (XHR) objects to interact with servers. We can retrieve data from a URL without having to do a full page refresh. This enables a web page to update just part of a page without disrupting what the user is doing.

We can configure the request with `xhr.open()`. `open()` method takes at least two arguments. **First** one describes the HTTP method. **Second**, that's the URL to which we want to send that request. For example:

```js
const xhr = new XMLHttpRequest();

xhr.open("GET", "https://my-json-server.typicode.com/typicode/demo/posts");
```

Now in order to send it, we have to call `xhr.send()` . This will send the request.

```js
const xhr = new XMLHttpRequest();

xhr.open("GET", "https://my-json-server.typicode.com/typicode/demo/posts");

xhr.send();
```

If you want to make sure that you send a request, go to the **developer tools** then **Network** tab. You will the `posts` here near the `app.js`, `style.css` and `index.html`.

## Format of the Data

We can exchange data between our client-side and the server-side in a certain format. We can send plain text, HTML markup, XML markup, csv file or as we typically do. We use this data format which is called **JSON** (stands for **JavaScript Object Notation**).

In JSON, we can only store data. We can't have methods or send functions to a server. **In addition**, our property names have to be wrapped between `"` double quotes. `'` single quote is not allowed in JSON format.

We can see what request we sent with `console.log(xhr.response)`:

```js
const xhr = new XMLHttpRequest();
xhr.open("GET", "https://my-json-server.typicode.com/typicode/demo/posts");

xhr.onload = () => console.log(xhr.response);

xhr.send();

/*
[
  {
    "id": 1,
    "title": "Post 1"
  },
  {
    "id": 2,
    "title": "Post 2"
  },
  {
    "id": 3,
    "title": "Post 3"
  }
]
*/
```

We can convert anything in JSON format to a object with `JSON.parse`. Indeed, it converts a **JavaScript** Object Notation (JSON) string into an object, for example:

```js
const xhr = new XMLHttpRequest();

xhr.open("GET", "https://my-json-server.typicode.com/typicode/demo/posts");

xhr.onload = function () {
  const listOfPosts = JSON.parse(xhr.response);
  console.log(listOfPosts);
};

xhr.send();

/*
(3) [{…}, {…}, {…}]
  0: {id: 1, title: "Post 1"}
  1: {id: 2, title: "Post 2"}
  2: {id: 3, title: "Post 3"}
  length: 3
  __proto__: Array(0)
*/
```

There is a little convenience built into the `XMLHttpRequest` object. That's `xhr.responeType`:

```js
const xhr = new XMLHttpRequest();

xhr.open("GET", "https://my-json-server.typicode.com/typicode/demo/posts");

xhr.responseType = "json";

xhr.onload = function () {
  //   const listOfPosts = JSON.parse(xhr.response);
  console.log(this.response);
};

xhr.send();

/*
(3) [{…}, {…}, {…}]
  0: {id: 1, title: "Post 1"}
  1: {id: 2, title: "Post 2"}
  2: {id: 3, title: "Post 3"}
  length: 3
  __proto__: Array(0)
*/
```

As you can see, the result is the same as before. Let's append the post to our page:

```js
const listElement = document.querySelector(".posts"); // ul tag
const postTemplate = document.getElementById("single-post"); // template tag

const xhr = new XMLHttpRequest();

xhr.open("GET", "https://my-json-server.typicode.com/typicode/demo/posts");

xhr.responseType = "json";

xhr.onload = function () {
  const listOfPosts = this.response;
  for (const post of listOfPosts) {
    const postEl = document.importNode(postTemplate.content, true);
    postEl.querySelector("h2").textContent = post.title.toUpperCase();
    postEl.querySelector("p").textContent = post.id;
    listElement.append(postEl);
  }
  console.log(listOfPosts);
};

/*
(3) [{…}, {…}, {…}]
  0: {id: 1, title: "Post 1"}
  1: {id: 2, title: "Post 2"}
  2: {id: 3, title: "Post 3"}
  length: 3
  __proto__: Array(0)
*/

xhr.send();
```

If we do that, we now see the posts on the screen.

## JSON Data Deep Dive

